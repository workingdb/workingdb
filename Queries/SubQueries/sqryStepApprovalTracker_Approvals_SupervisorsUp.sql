SELECT tblPartSteps.partNumber, tblPartInfo.description, tblPrograms.modelCode, tblDropDownsSP.partType, tblPrograms.OEM, tblPrograms.modelName, "Approve: " & [tblPartSteps]![stepType] AS [Action], IIf(IsNull([dueDate]),IIf(IsNull([soonestPillar]),IIf(IsNull([gateLastPillar]),[gatePlannedDate],[gateLastPillar]),[soonestPillar]),[duedate]) AS due, tblPartTeam.person, tblPartSteps.recordId, tblPartGates.gateTitle
FROM (sqryCountOfAttachments RIGHT JOIN (sqryPartProjectTags INNER JOIN (tblPartGates INNER JOIN (((tblDropDownsSP RIGHT JOIN (((tblPartTrackingApprovals INNER JOIN tblPartSteps ON tblPartTrackingApprovals.tableRecordId = tblPartSteps.recordId) LEFT JOIN tblPartInfo ON tblPartSteps.partNumber = tblPartInfo.partNumber) LEFT JOIN tblPrograms ON tblPartInfo.programId = tblPrograms.ID) ON tblDropDownsSP.recordid = tblPartInfo.partType) INNER JOIN tblPermissions ON (tblPartTrackingApprovals.reqLevel = tblPermissions.Level) AND (tblPartTrackingApprovals.dept = tblPermissions.Dept)) INNER JOIN tblPartTeam ON tblPartSteps.partNumber = tblPartTeam.partNumber) ON tblPartGates.recordId = tblPartSteps.partGateId) ON sqryPartProjectTags.recordId = tblPartSteps.partProjectId) ON sqryCountOfAttachments.partStepId = tblPartSteps.recordId) INNER JOIN qryFindNextPillar ON tblPartSteps.partGateId = qryFindNextPillar.partGateId
WHERE (((tblPartTeam.person)=[tblPermissions]![User]) AND ((tblPartTrackingApprovals.approvedOn) Is Null) AND ((sqryPartProjectTags.partProjectStatus)<>'On Hold') AND ((IIf(IsNull([tblPartSteps]![documentType]),True,[CountOfID]>0))=True) AND ((tblPartSteps.indexOrder)<=[qryFindNextPillar].[index]) AND ((tblPartTrackingApprovals.reqLevel)<>"Engineer"));

